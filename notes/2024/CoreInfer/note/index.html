<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>CoreInfer: Accelerating Large Language Model Inference with Semantics-Inspired Adaptive Sparse Activation - Efficient Paper</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.css" rel="stylesheet" />
        <link href="../../../../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "CoreInfer: Accelerating Large Language Model Inference with Semantics-Inspired Adaptive Sparse Activation";
        var mkdocs_page_input_path = "notes/2024/CoreInfer/note.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
 <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> Efficient Paper
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Paper List</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_year/">By Year</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_keyword/">By Keyword</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_publication/">By Publication</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_institution/">By Institution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_author/">By Author</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Weekly Paper</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/2025-07-25/">2025-07-25</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/2025-08-01/">2025-08-01</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/2025-08-08/">2025-08-08</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/2025-08-15/">2025-08-15</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/2025-08-22/">2025-08-22</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">Efficient Paper</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">CoreInfer: Accelerating Large Language Model Inference with Semantics-Inspired Adaptive Sparse Activation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
  
                <h1 id="coreinfer-accelerating-large-language-model-inference-with-semantics-inspired-adaptive-sparse-activation">CoreInfer: Accelerating Large Language Model Inference with Semantics-Inspired Adaptive Sparse Activation</h1>
<p><a class="glightbox" href="../framework.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../framework.png" /></a></p>
<h2 id="abstract">Abstract</h2>
<p>Large language models (LLMs) with billions of parameters have sparked a new
wave of exciting AI applications. However, their high computational costs and
memory demands during inference pose significant challenges. Adaptive sparse
activation inference, which activates only a small number of neurons for each
token, offers a novel way to accelerate model inference without degrading
performance, showing great potential for resource-constrained hardware devices.
Nevertheless, existing methods predict activated neurons based on individual
tokens with additional MLP, which involve frequent changes in activation maps
and resource calls, limiting the acceleration benefits of sparse activation. In
this paper, we introduce CoreInfer, an MLP-free adaptive sparse activation
inference method based on sentence-level prediction. Specifically, we propose
the concept of sentence-wise core neurons, which refers to the subset of
neurons most critical for a given sentence, and empirically demonstrate its
effectiveness. To determine the core neurons, we explore the correlation
between core neurons and the sentence's semantics. Remarkably, we discovered
that core neurons exhibit both stability and similarity in relation to the
sentence's semantics -- an insight overlooked by previous studies. Building on
this finding, we further design two semantic-based methods for predicting core
neurons to fit different input scenarios. In CoreInfer, the core neurons are
determined during the pre-filling stage and fixed during the encoding stage,
enabling zero-cost sparse inference. We evaluated the model generalization and
task generalization of CoreInfer across various models and tasks. Notably, on
an NVIDIA TITAN XP GPU, CoreInfer achieved a 10.33 times and 2.72 times speedup
compared to the Huggingface implementation and PowerInfer, respectively.</p>
<p>ä¹‹å‰å·¥ä½œå¯¹activation sparseçš„é¢„æµ‹æ˜¯æŒ‰ç…§token-wiseæ¥åšçš„ï¼Œè¿™æ ·æœ‰å‡ ä¸ªé—®é¢˜ï¼š
- Irregular and frequent resource calls during decoding
- Additional computation costs during decoding; ä½¿ç”¨MLPä½œä¸ºpredictorå¸¦æ¥çš„è®¡ç®—å¼€é”€ä¸èƒ½å¿½ç•¥</p>
<p>CoreInfer åˆ™æå‡ºsentence-wise activation sparsityæ–¹å¼ï¼Œå¹¶ä¸”æ²¡æœ‰MLPçš„predictorã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹ï¼š
- Token-wise Core Neurons.
    - æ¯ä¸ªtokenç»è¿‡ä¸€ä¸ªlayerè®¡ç®—åï¼Œå¯¹åº”å¤šä¸ªè¾“å‡ºï¼ˆneuronsï¼‰,å–ç»å¯¹å€¼æœ€å¤§çš„å‡ ä¸ªä½œä¸ºCore Neuronsã€‚
- Sentence-wise Core Neurons.
  - ä¸€ä¸ªsentenceå«æœ‰å¤šä¸ªtokenï¼Œæ¯ä¸ªtokenéƒ½å¯ä»¥æ ¹æ®ä»¥ä¸Šä¸€å®šæ‰¾åˆ°core neuronsï¼Œé€šè¿‡ç»Ÿè®¡æ¯ä¸ªneuronä½œä¸ºtoken-wise core neuronçš„æ¬¡æ•°ï¼Œæ¬¡æ•°æœ€å¤šçš„å‡ ä¸ªä½œä¸ºsentence-wise core neuronsã€‚</p>
<p><a class="glightbox" href="../eq1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../eq1.png" /></a></p>
<p><a class="glightbox" href="../eq2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../eq2.png" /></a></p>
<p>å¯ä»¥çœ‹åˆ°åˆ†åˆ«å¼•å…¥äº†<script type="math/tex">\alpha</script>
<script type="math/tex">\beta</script> ä¸¤ä¸ªè¶…å‚æ•°ï¼Œç”¨æ¥æ§åˆ¶core neuronsçš„æ¯”ä¾‹ã€‚</p>
<p><a class="glightbox" href="../fig2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../fig2.png" /></a>
é€šè¿‡è¿™ç§é€‰æ‹©ç­–ç•¥ï¼Œåªç”¨è®¡ç®—å°‘éƒ¨åˆ†çš„neuronsï¼Œä¾¿å¯ä»¥ç»´æŒç²¾åº¦ã€‚</p>
<p>å¦å¤–è§‚å¯Ÿï¼Œè¶Šä¸´è¿‘çš„tokensçš„core neuronsè¶Šç›¸ä¼¼ï¼Œæ‰€ä»¥å…·æœ‰è¯­ä¹‰ç›¸ä¼¼æ€§ã€‚</p>
<p>æ‰€ä»¥ï¼Œcoreinferæ ¹æ®å†å²çš„core neuronæ¥åˆ¤æ–­æœªæ¥çš„core neuronæ–¹æ³•å¦‚ä¸‹ï¼š
- Stability-guided Predictionï¼Œprefillé˜¶æ®µç»Ÿè®¡ï¼Œdecodingé˜¶æ®µç›´æ¥ä½¿ç”¨prefillçš„ç»Ÿè®¡ç»“æœ
- Similarity-guided Predictionï¼Œcoreinfer ç»Ÿè®¡äº†training dataï¼Œå¹¶æŒ‰ç…§è¯­ä¹‰å¯¹å…¶è¿›è¡Œäº†èšç±»ï¼Œä»è€Œå¯ä»¥æ ¹æ®è¯­ä¹‰ç›¸å…³æ€§æ¥åˆ¤æ–­core neuron ï¼ˆæœ‰äº›æŠ½è±¡ï¼‰</p>
<p>ç¬¬ä¸€ç§æ€æƒ³å’Œaggregated sparsityå¾ˆåƒï¼ŒLLM in a flash.</p>
              
  <!-- Giscusåªåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ˜¾ç¤ºï¼Œæœ¬åœ°å¼€å‘æ—¶éšè— -->

<div style="padding: 20px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 5px; margin: 20px 0;">
    <p><strong>ğŸ“ è¯„è®ºåŠŸèƒ½</strong></p>
    <p>è¯„è®ºåŠŸèƒ½ä»…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ã€‚åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­ï¼ŒGiscus æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>
    <p>è¯·è®¿é—®çº¿ä¸Šç‰ˆæœ¬æŸ¥çœ‹å®Œæ•´çš„è¯„è®ºåŠŸèƒ½ã€‚</p>
</div>


            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
      <script src="../../../../js/prism-prototxt.js"></script>
      <script src="../../../../js/preview.js"></script>
      <script src="../../../../js/back-to-top.js"></script>
      <script src="https://giscus.app/client.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body>
</html>
