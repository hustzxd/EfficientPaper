<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>Progressive Sparse Attention: Algorithm and System Co-design for Efficient Attention in LLM Serving - Efficient Paper</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Progressive Sparse Attention: Algorithm and System Co-design for Efficient Attention in LLM Serving";
        var mkdocs_page_input_path = "notes/2025/PSA/note.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> Efficient Paper
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Paper List</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_year/">By Year</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_keyword/">By Keyword</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_publication/">By Publication</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_institution/">By Institution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../cls_author/">By Author</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../weekly_paper/latest/">Weekly Paper</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">Efficient Paper</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Progressive Sparse Attention: Algorithm and System Co-design for Efficient Attention in LLM Serving</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="progressive-sparse-attention-algorithm-and-system-co-design-for-efficient-attention-in-llm-serving">Progressive Sparse Attention: Algorithm and System Co-design for Efficient Attention in LLM Serving</h1>
<p><img alt="" src="../fig4.png" /></p>
<h2 id="abstract">Abstract</h2>
<p>Processing long contexts has become a critical capability for modern large
language models (LLMs). However, serving long-context LLMs comes with
significant inference costs due to the high memory overhead of the key-value
(KV) cache. Existing work leverages dynamic sparse attention algorithms (DSAes)
to mitigate the KV cache overhead, but these algorithms rely on top-$k$ KV
cache selection, which results in a trade-off between accuracy and efficiency.
A larger $k$ improves accuracy but decreases efficiency, while a smaller $k$
boosts efficiency but compromises accuracy. To overcome this trade-off, this
paper presents PSA, a $\underline{P}$rogressive $\underline{S}$parse
$\underline{A}$ttention mechanism that integrates algorithmic innovations with
system co-design to achieve both high inference accuracy and improved
efficiency in LLM serving. The PSA algorithm adaptively adjusts the KV cache
budget of different tokens and layers according to their real attention weight
distributions, rather than relying on a fixed budget $k$. This enables high
accuracy while minimizing KV cache usage. To further enhance execution
efficiency, we introduce a pipelined iteration scheme that reduces CPU-GPU
interleaving and synchronization overhead during PSA computation. Additionally,
we implement unified GPU memory management that optimizes PSA's memory
utilization by accounting for uneven memory requirements across different model
layers. Extensive experimental results demonstrate that PSA reduces KV cache
usage for attention computation by up to 2.4$\times$ and 8.8$\times$, and
increases end-to-end serving throughput by up to 1.4$\times$ and 2.0$\times$,
compared to state-of-the-art DSAes and systems without sparse attention,
respectively.</p>
<p>不使用TOPk来选择KV block，首先对block进行重要性排序，然后依次计算，判断计算结果是否满足要求，否则就多算一个Block；</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
